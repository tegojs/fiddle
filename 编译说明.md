# Tachybase Fiddle 编译与配置说明

## 1. 如何编译项目

这是一个基于 **Electron Forge** 的 Electron 应用项目。编译方式如下：

### 开发模式运行
```bash
npm start
# 或
pnpm start
```

### 打包应用（不生成安装包）
```bash
npm run package
# 或
pnpm package
```
打包后的文件会生成在 `out/` 目录下。

### 生成安装包
```bash
npm run make
# 或
pnpm make
```
这会根据当前平台生成相应的安装包：
- **Windows**: 生成 `.exe` 安装包（在 `out/make/squirrel.win32/` 目录）
- **macOS**: 生成 `.zip` 文件（在 `out/make/zip/darwin/` 目录）
- **Linux**: 生成 `.deb`、`.rpm` 和 `.AppImage` 文件

### 发布到 GitHub
```bash
npm run publish
# 或
pnpm publish
```

---

## 2. 内置前端文件位置

前端文件主要分为两部分：

### 主应用前端文件
- **HTML 入口文件**: `static/index.html` - 主窗口的 HTML 模板
- **React 渲染进程代码**: `src/renderer/` - 包含所有 React 组件和渲染进程逻辑
  - `src/renderer/main.tsx` - 渲染进程入口
  - `src/renderer/components/` - React 组件
  - `src/renderer/app.tsx` - 主应用组件
- **样式文件**: `src/less/` - Less 样式文件
- **静态资源**: `static/css/` - 其他 CSS 文件

### 示例/模板文件
- **Electron 快速开始模板**: `static/electron-quick-start/`
- **Show Me 示例**: `static/show-me/` - 各种 Electron API 示例

### 配置说明
在 `forge.config.ts` 中，前端入口点配置如下：
```typescript
entryPoints: [
  {
    html: path.join(root, './static/index.html'),  // HTML 模板
    js: path.join(root, './src/renderer/main.tsx'), // React 入口
    name: 'main_window',
    preload: {
      js: path.join(root, 'src/preload/preload.ts'), // 预加载脚本
    },
  },
]
```

**总结**：如果要修改主应用的前端界面，主要编辑 `src/renderer/` 下的文件；如果要修改 HTML 模板，编辑 `static/index.html`。

---

## 3. 如何修改项目名称、产品名称等元信息

需要修改以下文件中的相关配置：

### 3.1 `package.json` 文件

修改以下字段：
```json
{
  "name": "tachybase-fiddle",           // 包名（npm 包名）
  "productName": "Tachybase Fiddle",    // 产品显示名称
  "version": "0.0.2",                   // 版本号
  "description": "The easiest way to get started with Tachybase",  // 描述
  "author": "Sealday <sealday@gmail.com>",  // 作者
  "keywords": ["Tachybase", "Fiddle", "Tutorial"]  // 关键词
}
```

### 3.2 `forge.config.ts` 文件

#### 修改应用名称和可执行文件名
在 `packagerConfig` 部分：
```typescript
packagerConfig: {
  name: 'Tachybase Fiddle',              // 应用名称（显示名称）
  executableName: 'tachybase-fiddle',    // 可执行文件名
  appBundleId: 'com.tachybase.fiddle',   // macOS Bundle ID
  // ...
}
```

#### 修改 Windows 元信息
在 `win32metadata` 部分：
```typescript
win32metadata: {
  CompanyName: 'Tachybase Community',    // 公司名称
  OriginalFilename: 'Tachybase Fiddle',  // 原始文件名
}
```

#### 修改 Windows 安装包信息
在 `makers` 配置中的 `@electron-forge/maker-squirrel` 部分：
```typescript
{
  name: '@electron-forge/maker-squirrel',
  platforms: ['win32'],
  config: (arch: string) => ({
    name: 'tachybase-fiddle',            // 安装包名称
    authors: 'Tachybase Community',      // 作者
    exe: 'tachybase-fiddle.exe',         // 可执行文件名
    setupExe: `tachybase-fiddle-${version}-win32-${arch}-setup.exe`,  // 安装包文件名
    // ...
  }),
}
```

#### 修改 Linux 应用信息
在 `commonLinuxConfig` 中：
```typescript
const commonLinuxConfig = {
  categories: ['Development', 'Utility'],  // 应用分类
  // ...
  mimeType: ['x-scheme-handler/tachybase-fiddle'],  // MIME 类型
};
```

#### 修改协议处理
在 `protocols` 部分：
```typescript
protocols: [
  {
    name: 'Tachybase Fiddle Launch Protocol',  // 协议名称
    schemes: ['tachybase-fiddle'],              // URL scheme
  },
]
```

### 3.3 `static/index.html` 文件

修改 HTML 中的标题：
```html
<title>Tachybase Fiddle</title>
```

### 3.4 图标文件

图标文件位于 `assets/icons/` 目录：
- `fiddle.ico` - Windows 图标
- `fiddle.icns` - macOS 图标
- `fiddle.png` - Linux 图标（1024x1024）
- `fiddle.svg` - Linux 矢量图标

如果要更换图标，需要替换这些文件，并确保文件名和路径在 `forge.config.ts` 中正确配置。

---

## 快速修改清单

如果要重命名整个项目，建议按以下顺序修改：

1. ✅ `package.json` - `name`, `productName`, `description`, `author`
2. ✅ `forge.config.ts` - `packagerConfig.name`, `executableName`, `appBundleId`
3. ✅ `forge.config.ts` - `win32metadata.CompanyName`, `win32metadata.OriginalFilename`
4. ✅ `forge.config.ts` - `makers` 中的 `name`, `authors`, `exe`, `setupExe`
5. ✅ `static/index.html` - `<title>` 标签
6. ✅ 图标文件（如需要）- `assets/icons/` 目录下的文件
7. ✅ `README.md` - 项目说明文档

修改完成后，运行 `npm run make` 重新编译即可。

